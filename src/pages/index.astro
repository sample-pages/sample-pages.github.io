---
import Layout from "../layouts/Layout.astro";

const allPosts = await Astro.glob("./posts/*.md");
const nonDraftPosts = allPosts.filter((post) => !post.frontmatter.draft);

const sortedPosts = nonDraftPosts.sort((a, b) => {
  const aDate = new Date(a.frontmatter.pubDate);
  const bDate = new Date(b.frontmatter.pubDate);
  return bDate.getTime() - aDate.getTime();
});

const latestPosts = sortedPosts.slice(0, 3);
---

<script>
  const revealElements = document.querySelectorAll('.reveal');

const io = new IntersectionObserver((entries, observer) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('is-visible');
      // 一度だけアニメーションさせるなら unobserve（コメントアウトすると何度でも発火）
      observer.unobserve(entry.target);
    } else {
      // もしスクロールで再度非表示→再表示したいならこの行を有効化
      // entry.target.classList.remove('is-visible');
    }
  });
}, {
  threshold: 0.5,           // 15% 見えたら発火
  rootMargin: '0px 0px -10% 0px' // 少し早めに発火させたい場合
});

revealElements.forEach(el => io.observe(el));
</script>

<Layout title="ホーム｜第8回うぃーすた全国交流会">
  <a href="/register/"
  class="fixed sm:right-14 sm:bottom-14 max-sm:right-4 max-sm:bottom-4 sm:w-32 sm:h-32 max-sm:w-24 max-sm:h-24 rounded-full bg-red-700 text-white shadow-xl flex flex-col items-center justify-center z-50
   zen-kaku-gothic-new
  hover:bg-red-800 hover:scale-105 transition-transform transition-all duration-200"
>
<span class="sm:mt-6 max-sm:mt-4 max-sm:text-[12px] max-sm:font-semibold">お申し込みは</span>
<span class="max-sm:text-[12px] max-sm:font-semibold">こちら</span>
<i class="ri-arrow-right-line block sm:text-2xl max-sm:text-xl"></i>
</a>
  <div class="max-lg:h-[300px] lg:h-[500px]" style="background-image: url('/images/loading.jpeg'); background-size: cover; background-position: center; width: 100%;"></div>
  <!--
  <div class="img-frame hero" style="margin-top: -92px;">
      <div class="img-01" style="background-image: url('/images/GtFcDSubkAAeYmu-2.jpg');"></div>
      <div class="img-02" style="background-image: url('/images/GYFsma4b0AMhqPv-2.jpg');"></div>
      <div class="img-03" style="background-image: url('/images/GVPL3lxaEAAgoiI.jpg');"></div>
  </div>
-->
  <!--
  <div class="scroll_down" id="type03">
    <a href="#">Scroll</a>
  </div>
-->
  <div class="margin-contents text-color zen-kaku-gothic-new">
    <div style="height: 30px;"></div>
    <p class="max-xl:text-base xl:text-lg resp-sm-g" style="text-align: center;">「第8回うぃーすた全国交流会」を<br>2026年7月18日(土)〜19日(日)に大阪にて開催します！</p>
    <p class="max-xl:text-base xl:text-lg resp-sm-f" style="text-align: center;">「第8回うぃーすた全国交流会」を<br>2026年7月18日(土)〜19日(日)に<br>大阪にて開催します！</p>
    <div style="height: 60px;"></div>
    <!--
    <div class="cards-container text-color text-font max-lg:gap-10">
    <a class="card-link">
      <div class="sche-card pic-image">
          <div class="sche-box">
              <div style="height: 8px;"></div>
              <h2 class="card-title">7月18日(<span style="color: #4476ff;">土</span>)</h2>
              <p class="card-description text-start">
                14:00～14:20&emsp;開会式<br>
                14:20～16:20&emsp;グループトーク<br>
                16:30～17:30&emsp;講演<br>
                19:00～21:00&emsp;夕食<br>
                21:00～&emsp;フリータイム<br></p>
          </div>
      </div>
    </a>
    <a class="card-link">
      <div class="sche-card pic-image">
          <div class="sche-box">
              <div style="height: 8px;"></div>
              <h2 class="card-title">7月19日(<span style="color: #ff4444;">日</span>)</h2>
              <p class="card-description text-start">
                7:00〜8:30&emsp;朝食<br>
                9:00～10:00&emsp;マイメッセージ<br>
                10:10～11:10&emsp;クイズ大会<br>
                11:20～11:40&emsp;閉会式<br>
                13:00～&emsp;昼食<br></p>
          </div>
      </div>
    </a>
  </div>
  -->

    <div
      class="reveal fade-up max-lg:p-6 lg:p-8 text-color margin-contents bg-white rounded-[40px] shadow-md"
      style="max-width: 900px; width: 100%;"
    >
    <span class="midashi mb-4">お知らせ</span>
    <div style="height: 10px;"></div>
    <ul style="margin-left: 0.25rem; margin-right: 0.25rem;">
      {
        latestPosts.map((post) => (
          <li>
            {post.frontmatter.update ? (
              <div class="update-content">
                <a class="text-lg">{post.frontmatter.date}</a>
                &nbsp;
                <a class="text-lg">{post.frontmatter.update}</a>
              </div>
            ) : (
              <div class="no-update-content">
                <a class="text-base max-lg:text-xs">{post.frontmatter.date}</a>
              </div>
            )}
            <a class="text-lg max-lg:text-sm font-medium hover-color" href={post.url}>
              {post.frontmatter.title}
            </a>
            <br />
            <a class="text-base">{post.frontmatter.description}</a>
            <div style="height: 24px;" />
          </li>
        ))
      }
    </ul>
    <br />
    <div class="flex items-center justify-center" style="margin-bottom: 4px;">
      <a href="/posts/1"
         class="text-base max-xl:text-sm flex items-center justify-center 
                bg-black text-white rounded-3xl px-5 py-3 hover:bg-gray-500 transition">
        すべて見る&nbsp;
        <i class="ri-arrow-right-line" style="font-size: 20px;"></i>
      </a>
    </div>
    </div>
    <div style="height: 70px;" />
  </div>
</Layout>
