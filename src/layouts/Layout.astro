---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import "katex/dist/katex.min.css";

import "remixicon/fonts/remixicon.css";
import "../styles/output.css";

const { title } = Astro.props;
---

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="../styles/output.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
      integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0"
      crossorigin="anonymous"
    />
    <!-- ファビコン -->
    <link rel="icon" type="image/png" href="/images/logo.png">

    <!-- iOS ホーム画面用 -->
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">


    <title>{title}</title>
    <meta name="description" content="『第8回うぃーすた全国交流会』を2026年7月18日(土)〜19日(日)に大阪にて開催します！">
    <script>
      // --- 初期設定 ---
let targetScroll = window.scrollY;
let isTouchScrolling = false;
let startTouchY = 0;
let startScrollY = 0;

// --- マウスホイール対応 ---
window.addEventListener("wheel", e => {
  e.preventDefault(); // デフォルトスクロール停止
  targetScroll += e.deltaY * 0.7; // スクロール量を半分にして重く
  // ページ範囲内に制限
  targetScroll = Math.max(0, Math.min(document.body.scrollHeight - window.innerHeight, targetScroll));
}, { passive: false });

// --- タッチスクロール対応 ---
window.addEventListener("touchstart", e => {
  isTouchScrolling = true;
  startTouchY = e.touches[0]?.clientY ?? 0;
  startScrollY = targetScroll;
}, { passive: true });

window.addEventListener("touchmove", e => {
  if (!isTouchScrolling) return;
  const deltaY = startTouchY - (e.touches[0]?.clientY ?? startTouchY);

  targetScroll = startScrollY + deltaY * 0.7; // スクロール量を半分にして重く
  targetScroll = Math.max(0, Math.min(document.body.scrollHeight - window.innerHeight, targetScroll));
}, { passive: true });

window.addEventListener("touchend", _ => {
  isTouchScrolling = false;
});

// --- スムーズスクロール ---
function smoothScroll() {
  const currentScroll = window.scrollY;
  const diff = targetScroll - currentScroll;
  // 小さい差なら移動させない
  if (Math.abs(diff) > 0.5) {
    window.scrollTo(0, currentScroll + diff * 0.1); // 0.1を小さくするとより重くなる
  }
  requestAnimationFrame(smoothScroll);
}

smoothScroll();

    </script>
  </head>
  <!--style="overscroll-behavior-y: none;" -->
  <body class="margin-body flex flex-col min-h-screen overflow-x-hidden" id="page-top">
    <Header />
    <main class="grow">
      <slot />
    </main>
    <Footer />
  </body>
</html>
